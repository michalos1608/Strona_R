---
title: "Analiza Danych: Sen Ssaków"
output: workflowr::wflow_html
---

## 1. Opis zbioru danych

W tej analizie wykorzystujemy zbiór danych `gapminder`. Zawiera on statystyki dotyczące krajów z całego świata, obejmujące: **PKB na osobę** (gdpPercap), **Oczekiwaną długość życia** (lifeExp), **Populację** (pop).

Dane pochodzą z pakietu `gapminder` i pozwalają na śledzenie zmian demograficznych i ekonomicznych na przestrzeni lat.

### Ładowanie pakietów i danych

```{r setup, message=FALSE, warning=FALSE}
library(tidyverse)
library(gapminder)
library(knitr)
```

### Pierwsze 6 wierszy

```{r}
wiersze <- kable(head(gapminder), caption = "Pierwsze 6 wierszy zbioru gapminder")
wiersze
```

## 2. Przetwarzanie danych

### Filtrowanie danych dla roku 2007

```{r}
dane_2007 <- gapminder %>%
  filter(year == 2007) %>%
  mutate(pkb_calkowite = gdpPercap * pop)
```

### Grupowanie danych według kontynentów

```{r}
statystyki_kontynenty <- dane_2007 %>%
  group_by(continent) %>%
  summarise(
    srednia_dlugosc_zycia = mean(lifeExp),
    srednie_pkb_per_capita = mean(gdpPercap),
    liczba_krajow = n()
  )

kable(statystyki_kontynenty, caption = "Tabela 2: Statystyki zagregowane dla kontynentów (2007)")
```

## 3. Wizualizacja
#
#
### Wykres 1

```{r}

ggplot(statystyki_kontynenty, aes(x = continent, y = srednia_dlugosc_zycia, fill = continent)) +
  geom_col() +
  labs(
    title = "Średnia oczekiwana długość życia wg kontynentów (2007)",
    x = "Kontynent",
    y = "Wiek (lata)"
  ) +
  theme_minimal()
  
```
# Wnioski : Najwyższą średnią długością życia charakteryzują się mieszkańcy Oceanii oraz Europy

#
#
### Wykres 1
```{r}

ggplot(dane_2007, aes(x = gdpPercap, y = lifeExp, color = continent, size = pop)) +
  geom_point(alpha = 0.7) +
  scale_x_log10() + 
  labs(
    title = "Zależność między PKB a długością życia",
    x = "PKB na osobę (skala logarytmiczna)",
    y = "Oczekiwana długość życia",
    color = "Kontynent",
    size = "Populacja"
  ) +
  theme_bw()

```

```{r}

ggplot(dane_2007, aes(x = continent, y = gdpPercap, fill = continent)) +
  geom_boxplot() +
  scale_y_log10() +
  labs(
    title = "Rozkład PKB na osobę wg kontynentów",
    x = "Kontynent",
    y = "PKB na osobę"
  ) +
  theme_light()
```
